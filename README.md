# :pushpin: Modeul
>모들 - 지역기반 공동구매 커뮤니티 프로젝트
> 
</br>

## 1. 제작 기간 & 참여 인원
- 2023년 03월 02일 ~ 05월 25일
- 팀 프로젝트

</br>

## 2. 사용 기술
#### `Back-end`
  - Java 17
  - Spring Boot 3.0
  - Maven
  - Mybatis
  - MariaDB
  - Spring Security

#### `Front-end`
  - Vue.js 3.0

</br>

## 3. ERD 설계


</br>

## 4. 핵심 기능
공동구매 서비스는 사용자가 게시글을 작성하여 다른 사용자와 함께 [공동구매, 배달, 대형마트]를 공유할 수 있는 서비스입니다.
서비스를 이용하기 위해서는 로그인이 필수이며, 로그인 없이 회원가입, 로그인 서비스에 한해서만 이용할 수 있습니다.

<details>
<summary><b>핵심 기능 설명 펼치기</b></summary>
<div markdown="1">
</details>
  
</br>
  
### 4.1. 전체 흐름

</br>

### 4.2. 사용자 요청

</br>

### 4.3. Controller

</br>

### 4.4. Service


</br>

### 4.5. Repository




</br>

## 5. 핵심 트러블 슈팅

### 5.1. 채팅방 내부의 채팅 메시지를 어떻게 저장해서 채팅방에 다시 불러올 것인지에 대한 문제

<br>
- 문제점 :
  - 채팅방 내부의 채팅 메시지를 어떻게 저장해서 채팅방에 다시 불러올 것인지?
  - 채팅방을 나갔다가 들어오면 채팅 메시지를 불러오는 과정이 필요하다고 판단되어서 채팅방 내부의 메시지를 저장하려고 했다. 초기의 구현 방법은 메시지를 1번 입력할 때마다 DB에 메시지를 저장하고 불러오는 방식으로 구현하고자 했다.

<br>
- 원인 :
  - 하지만, 구현하고보니 서버와 DB에 과부하를 주는 모습을 확인할 수 있어서 성능이 급격히 나빠진 것으로 판단되었다. 이를 수정하기위해 다양한 방식으로 수정하려고 했다.

<br>
- 해결 방법 :
  - 채팅 메시지를 한 번 입력할 때마다 DB에 저장하는 방법과 파일에 저장하는 방법이 있었지만, 팀원들이 모두 채팅 메시지를 공유할 수 있고 DB에서 바로 확인할 수 있기 때문에 DB에 채팅 메시지를 저장하기로 했다.
  - 또한, 채팅 메시지를 한번 입력할 때마다 DB에 바로 저장하기보다는 브라우저에서 벗어날 때마다 DB에 메시지를 저장하기로 했다.
  - 이렇게 구현하면, 서버 요청의 빈번도와 DB의 IO 빈번도를 줄일 수 있어서 성능을 높일 수 있는 결과를 만들었다.

<br>
- 배운점 : 
  - 메시지를 저장하기 위해서는 매번 IO가 일어날 필요도 없었고 서버나 DB의 부하를 최대한 줄이는 방향으로 개발해야한다는 점을 알게 되었다. 

---

<br><br>

### 5.2. 정산 내역을 DB에 저장하기 위해 @RequestBody를 여러 개 사용할 수 없다는 에러가 발생하는 문제

<br>
- 문제점 :
  - 정산 시스템 구현에서 dutch, account 칼럼을 포함하는 기존의 구현 방식으로는 정규화가 위반되어 이를 개선하기 위해 DB 테이블 구조 변경
  - 기존 1개의 DB 테이블이 2개의 DB 테이블로 DB 테이블 구조가 변경됨에 따라 DB에 정산 내역을 저장하기 위해서 JSON 데이터 구조도 같이 변경되었다.
  - POST 요청으로 정산 내역을 DB에 저장하기 위해 Spring Boot에서는 JSON 데이터 타입을 @RequestBody에 각각의 객체를 담아서 DB 테이블에 저장하려고 했지만 @RequestBody를 여러 개 사용할 수 없다는 에러가 발생했다. 


<br>
- 원인 :
  - @RequestBody는 JSON 데이터를 HTTP 요청 Body로 받아 자바 객체로 변환하여 Request Stream으로 받기 때문에 단일 객체만을 처리할수 있도록 처리되어 있다.
  - 따라서, @RequestBody를 사용하기 위해서는 다른 방법을 이용해야 한다. 


<br>
- 해결 방법 : 
  - DTO를 추가로 생성하여 처리하거나 JSON 데이터를 여러 객체로 나누어서 처리한다. 
  - DTO를 사용하는 경우는 최초 개발 시점에서만 처리가능하기 때문에 JSON 데이터를 여러 객체로 나누어서 처리하는 방향으로 진행하였다.

---

</br>
## 6. 그 외 트러블 슈팅
<details>
  
</br>
## 6. 회고 / 느낀점
>프로젝트 개발 회고 글: